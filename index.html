<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Moore Club - La Tentación Empieza Aquí</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: url('mooreclub1.png') center top no-repeat;
      background-size: cover;
      background-attachment: fixed;
    }
    .bg-overlay {
      background-color: rgba(0,0,0,0.85);
    }
    .btn {
      background-color: #6b21a8;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-right: 0.5rem;
    }
    .btn:hover {
      background-color: #5b189b;
    }
    #mensaje {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background-color: #9f7aea;
      color: white;
      border-radius: 0.375rem;
      font-weight: 600;
      opacity: 0;
      transition: opacity 0.3s ease;
      max-width: 300px;
    }
    #mensaje.visible {
      opacity: 1;
    }
  </style>
</head>
<body class="text-purple-200">

  <div class="bg-overlay min-h-screen">

    <nav class="bg-purple-900 text-white px-6 py-4 flex justify-between items-center">
      <h1 class="text-xl font-bold cursor-pointer" onclick="mostrarInicio()">Moore Club</h1>
      <ul class="flex space-x-6 text-sm">
        <li><a href="#" onclick="mostrarInicio()" class="hover:underline">Inicio</a></li>
        <li><a href="#" onclick="empleadoActual ? mostrarPanelEmpleados() : mostrarLoginFichaje()" class="hover:underline">Empleados</a></li>
      </ul>
    </nav>

    <main id="contenido" class="p-8">
      <h2 class="text-2xl font-bold mb-4">Bienvenido a Moore Club</h2>
      <p>Explora nuestras secciones y vive la experiencia.</p>
    </main>

  </div>

<script>
  // Datos y estados
  let empleadoActual = null;

  let estadosTrabajo = JSON.parse(localStorage.getItem('estadosTrabajo')) || {
    'tito giovanni': { fichado: false, inicio: null, tiempoAcumulado: 0 },
    'marta as': { fichado: false, inicio: null, tiempoAcumulado: 0 }
  };

  const productosPeluches = [
    { id: 'tito', nombre: 'Tito Dios Griego', img: 'tito.png' },
    { id: 'tita', nombre: 'La Tita', img: 'tita.png' },
    { id: 'mascara', nombre: 'Máscara Dominante “Cat Vanilla”', img: 'mascara.png' },
    { id: 'pinzas', nombre: 'Pinzas LED “Sweet Pain”', img: 'pinzas.png' },
    { id: 'condones', nombre: 'Condones “Espadas del Deseo”', img: 'condones.png' },
    { id: 'dildo', nombre: 'Dildo Doble “Fusión Morada”', img: 'dildo.png' }
  ];

  let ventasPeluches = JSON.parse(localStorage.getItem('ventasPeluches')) || {
    tito: 0, tita: 0, mascara: 0, pinzas: 0, condones: 0, dildo: 0
  };

  const productosComida = [
    { id: 'banana', nombre: 'Banana pelada con glaseado y cerezas', img: 'banana.png', descripcion: 'Provocadora y dulce hasta el final.' },
    { id: 'magdalenas', nombre: 'Magdalenas con glaseado rosa', img: 'magdalenas.png', descripcion: 'Dos razones para pecar.' },
    { id: 'berenjena', nombre: 'Berenjena rellena', img: 'berenjena.png', descripcion: 'Caliente y jugosa, te va a dejar sudando.' },
    { id: 'coctel', nombre: 'Cóctel dulce con cereza y fresa', img: 'coctel.png', descripcion: 'Tierno al principio, travieso al final.' },
    { id: 'trago', nombre: 'Trago afrutado y ácido', img: 'trago.png', descripcion: 'Refresca y se te queda pegado.' },
    { id: 'almejas', nombre: 'Almejas picantes con limón', img: 'almejas.png', descripcion: 'Suave por fuera, fuego por dentro.' }
  ];

  let ventasComida = JSON.parse(localStorage.getItem('ventasComida')) || {
    banana: 0, magdalenas: 0, berenjena: 0, coctel: 0, trago: 0, almejas: 0
  };

  // Guardar estados
  function guardarEstadosTrabajo() {
    localStorage.setItem('estadosTrabajo', JSON.stringify(estadosTrabajo));
  }
  function guardarVentasPeluches() {
    localStorage.setItem('ventasPeluches', JSON.stringify(ventasPeluches));
  }
  function guardarVentasComida() {
    localStorage.setItem('ventasComida', JSON.stringify(ventasComida));
  }

  // Mensajes sin alertas
  function mostrarMensaje(texto) {
    const mensaje = document.getElementById('mensaje');
    if (!mensaje) return;
    mensaje.textContent = texto;
    mensaje.classList.add('visible');
    setTimeout(() => mensaje.classList.remove('visible'), 3000);
  }

  // UI

  function mostrarInicio() {
    empleadoActual = null;
    document.getElementById('contenido').innerHTML = `
      <h2 class="text-2xl font-bold mb-4">Bienvenido a Moore Club</h2>
      <p>Explora nuestras secciones y vive la experiencia.</p>
    `;
  }

  // Login fichaje (solo para fichar)
  function mostrarLoginFichaje() {
    document.getElementById('contenido').innerHTML = `
      <h2 class="text-2xl font-bold mb-4">Acceso Empleado</h2>
      <div class="max-w-md bg-black bg-opacity-30 p-6 rounded shadow">
        <label class="block mb-2">Nombre completo (minúsculas)</label>
        <input id="nombreEmpleado" type="text" class="w-full px-3 py-2 mb-4 text-black" placeholder="Ej: tito giovanni" />
        <button onclick="loginEmpleado()" class="btn w-full">Entrar</button>
      </div>
      <div id="mensaje"></div>
    `;
  }

  function loginEmpleado() {
    const nombre = document.getElementById('nombreEmpleado').value.trim().toLowerCase();
    if (!nombre) {
      mostrarMensaje('Introduce un nombre válido');
      return;
    }
    if (!(nombre in estadosTrabajo)) {
      mostrarMensaje('Empleado no registrado');
      return;
    }
    empleadoActual = nombre;
    mostrarPanelEmpleados();
  }

  function cerrarSesion() {
    empleadoActual = null;
    mostrarInicio();
  }

  // Panel empleados con submenú
  function mostrarPanelEmpleados() {
    const contenido = document.getElementById('contenido');
    contenido.innerHTML = `
      <h2 class="text-2xl font-bold mb-4">Panel Empleados - ${empleadoActual}</h2>
      <div class="mb-4 space-x-4">
        <button class="btn" onclick="mostrarFichaje()">Fichaje</button>
        <button class="btn" onclick="mostrarVentasPeluches()">Ventas Peluches</button>
        <button class="btn" onclick="mostrarVentasComida()">Ventas Comida</button>
        <button class="btn bg-red-600 hover:bg-red-700" onclick="cerrarSesion()">Cerrar Sesión</button>
      </div>
      <div id="subcontenido"></div>
      <div id="mensaje"></div>
    `;
    mostrarFichaje();
  }

  // Fichaje
  function mostrarFichaje() {
    const subcontenido = document.getElementById('subcontenido');
    const estado = estadosTrabajo[empleadoActual];
    subcontenido.innerHTML = `
      <button class="btn mr-2" onclick="ficharEntrada()">Fichar Entrada</button>
      <button class="btn mr-2" onclick="ficharSalida()">Fichar Salida</button>
      <div class="mt-4" id="estadoGeneral"></div>
    `;
    actualizarEstadoGeneral();
  }

  function ficharEntrada() {
    const estado = estadosTrabajo[empleadoActual];
    if (estado.fichado) {
      mostrarMensaje('Ya estás fichado');
      return;
    }
    estado.fichado = true;
    estado.inicio = Date.now();
    guardarEstadosTrabajo();
    actualizarEstadoGeneral();
    mostrarMensaje('Fichado correctamente');
  }

  function ficharSalida() {
    const estado = estadosTrabajo[empleadoActual];
    if (!estado.fichado) {
      mostrarMensaje('No estás fichado');
      return;
    }
    estado.fichado = false;
    estado.tiempoAcumulado += Date.now() - estado.inicio;
    estado.inicio = null;
    guardarEstadosTrabajo();
    actualizarEstadoGeneral();
    mostrarMensaje('Salida registrada');
  }

  function actualizarEstadoGeneral() {
    const cont = document.getElementById('estadoGeneral');
    const hoy = new Date();
    const inicioDia = new Date(hoy.getFullYear(), hoy.getMonth(), hoy.getDate()).getTime();
    const diaSemana = hoy.getDay();
    const inicioSemana = new Date(hoy.getFullYear(), hoy.getMonth(), hoy.getDate() - ((diaSemana + 6) % 7)).getTime();

    let html = `<table class="min-w-full text-left border-collapse border border-purple-600">
      <thead>
        <tr class="bg-purple-800">
          <th class="border border-purple-700 px-4 py-2">Empleado</th>
          <th class="border border-purple-700 px-4 py-2">Horas hoy</th>
          <th class="border border-purple-700 px-4 py-2">Horas esta semana</th>
          <th class="border border-purple-700 px-4 py-2">Horas totales</th>
          <th class="border border-purple-700 px-4 py-2">Estado</th>
        </tr>
      </thead>
      <tbody>`;

    function msAHoras(ms) {
      return (ms / 3600000).toFixed(2);
    }

    for (const [usuario, datos] of Object.entries(estadosTrabajo)) {
      let tiempoAcumulado = datos.tiempoAcumulado;
      let tiempoHoy = 0;
      let tiempoSemana = 0;

      if (datos.fichado && datos.inicio) {
        const ahora = Date.now();
        tiempoAcumulado += (ahora - datos.inicio);
        if (datos.inicio > inicioDia) {
          tiempoHoy += ahora - datos.inicio;
        }
        if (datos.inicio > inicioSemana) {
          tiempoSemana += ahora - datos.inicio;
        }
      }

      html += `<tr>
        <td class="border border-purple-700 px-4 py-2">${usuario}</td>
        <td class="border border-purple-700 px-4 py-2">${msAHoras(tiempoHoy)}</td>
        <td class="border border-purple-700 px-4 py-2">${msAHoras(tiempoSemana)}</td>
        <td class="border border-purple-700 px-4 py-2">${msAHoras(tiempoAcumulado)}</td>
        <td class="border border-purple-700 px-4 py-2">${datos.fichado ? 'Fichado' : 'No fichado'}</td>
      </tr>`;
    }
    html += '</tbody></table>';
    cont.innerHTML = html;
  }

  // Ventas Peluches
  function mostrarVentasPeluches() {
    const subcontenido = document.getElementById('subcontenido');
    let html = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6">`;
    productosPeluches.forEach(p => {
      html += `
        <div class="bg-black bg-opacity-30 p-4 rounded">
          <h3 class="font-semibold mb-2">${p.nombre}</h3>
          <img src="${p.img}" alt="${p.nombre}" class="w-24 mb-2" />
          <p>Total vendido: <strong id="total-${p.id}">${ventasPeluches[p.id]}</strong></p>
          <input type="number" id="input-${p.id}" min="1" placeholder="Cantidad a añadir" class="w-full px-2 py-1 mb-2 text-black" />
          <button onclick="agregarVenta('${p.id}')" class="btn w-full">Añadir ventas</button>
        </div>`;
    });
    html += '</div>';
    subcontenido.innerHTML = html;
  }

  function agregarVenta(id) {
    const input = document.getElementById(`input-${id}`);
    const valor = parseInt(input.value);
    if (isNaN(valor) || valor <= 0) {
      mostrarMensaje('Introduce una cantidad válida');
      return;
    }
    ventasPeluches[id] += valor;
    guardarVentasPeluches();
    document.getElementById(`total-${id}`).textContent = ventasPeluches[id];
    input.value = '';
  }

  // Ventas Comida y Bebida
  function mostrarVentasComida() {
    const subcontenido = document.getElementById('subcontenido');
    let html = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6">`;
    productosComida.forEach(p => {
      html += `
        <div class="bg-black bg-opacity-30 p-4 rounded">
          <h3 class="font-semibold mb-2">${p.nombre}</h3>
          <img src="${p.img}" alt="${p.nombre}" class="w-24 mb-2" />
          <p class="italic mb-2">${p.descripcion}</p>
          <p>Total vendido: <strong id="total-comida-${p.id}">${ventasComida[p.id]}</strong></p>
          <input type="number" id="input-comida-${p.id}" min="1" placeholder="Cantidad a añadir" class="w-full px-2 py-1 mb-2 text-black" />
          <button onclick="agregarVentaComida('${p.id}')" class="btn w-full">Añadir ventas</button>
        </div>`;
    });
    html += '</div>';
    subcontenido.innerHTML = html;
  }

  function agregarVentaComida(id) {
    const input = document.getElementById(`input-comida-${id}`);
    const valor = parseInt(input.value);
    if (isNaN(valor) || valor <= 0) {
      mostrarMensaje('Introduce una cantidad válida');
      return;
    }
    ventasComida[id] += valor;
    guardarVentasComida();
    document.getElementById(`total-comida-${id}`).textContent = ventasComida[id];
    input.value = '';
  }

</script>

</body>
</html>

